(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{258:function(e,t,a){e.exports=a(588)},263:function(e,t,a){},588:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(21),l=a.n(i),c=(a(263),a(45)),s=a(46),o=a(50),u=a(47),m=a(51),d=a(81),g=a.n(d),h=function(){return g.a.get("/api/readings").then(function(e){return e.data})},E=function(){return g.a.get("/api/sensors").then(function(e){return e.data})},f=a(82),p=a(208),y=a.n(p),v=a(210),b=a.n(v),D=a(211),w=a.n(D),S=a(212),k=a.n(S),O=a(213),x=a.n(O),j=a(214),C=a.n(j),R=a(215),I=a.n(R),M=a(216),T=a.n(M),K=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).toggleDrawer=function(e){return function(){a.setState({drawerOpen:e})}},a.state={drawerOpen:!1},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e.root},r.a.createElement(y.a,{position:"static"},r.a.createElement(b.a,null,r.a.createElement(w.a,{className:e.menuButton,color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer(!0)},r.a.createElement(k.a,null)))),r.a.createElement(x.a,{open:this.state.drawerOpen,onClose:this.toggleDrawer(!1),variant:"temporary",anchor:"left"},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer(!1),onKeyDown:this.toggleDrawer(!1)},r.a.createElement(C.a,null,["Home","Settings"].map(function(e,t){return r.a.createElement(I.a,{button:!0,key:e},r.a.createElement(T.a,{primary:e}))})))))}}]),t}(r.a.Component),N=Object(f.withStyles)({root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20}})(K),B=a(32),G=function(e){var t=e.data,a=e.yDataKeys,n=e.yUnit,i=e.yDomain,l=e.xDataKey,c=e.boundaries;return r.a.createElement(B.e,{width:"90%",height:300},r.a.createElement(B.c,{cx:"50%",cy:"50%",outerRadius:"80%",data:t},a.map(function(e){return r.a.createElement(B.b,{key:e,type:"monotone",dataKey:e,stroke:"#7D53DE",dot:!1,name:e.charAt(0).toUpperCase()+e.slice(1),unit:n})}),r.a.createElement(B.a,{stroke:"#ccc",vertical:!1}),r.a.createElement(B.g,{dataKey:l,tick:!1,type:"number",domain:["dataMin","dataMax"]}),r.a.createElement(B.h,{type:"number",domain:i,allowDecimals:!1}),r.a.createElement(B.f,null),c.map(function(e){return r.a.createElement(B.d,{key:e,x:e,stroke:"blue",label:new Date(e).toDateString()})})))},L=function(e){var t=e.user,a=(new Date).getHours();return a>=4&&a<=10?r.a.createElement("div",{className:"greeting"},"Good Morning ",r.a.createElement("br",null)," ",r.a.createElement("span",null,t)):a>=22||a<=3?r.a.createElement("div",{className:"greeting"},"Good Night ",r.a.createElement("br",null)," ",r.a.createElement("span",null,t)):a>=18&&a<22?r.a.createElement("div",{className:"greeting"},"Good Evening ",r.a.createElement("br",null)," ",r.a.createElement("span",null,t)):r.a.createElement("div",{className:"greeting"},"Good Day ",r.a.createElement("br",null)," ",r.a.createElement("span",null,t))},A=a(24),U=a.n(A),H={weekday:"long",month:"long",day:"numeric"},F=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={time:new Date},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.intervalID=setInterval(function(){return e.tick()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"tick",value:function(){this.setState({time:new Date})}},{key:"render",value:function(){return r.a.createElement("div",{className:"timeDateDisplay"},r.a.createElement(U.a,{variant:"h2"},this.state.time.toLocaleString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})),r.a.createElement(U.a,{variant:"h6"},this.state.time.toLocaleDateString("en-GB",H)))}}]),t}(r.a.Component),J=function(e,t){var a=e.reduce(function(e,a){return e+a[t]},0);return Math.round(a/e.length*100)/100},W=function(e){var t=e.data,a=e.boundaries;return r.a.createElement("div",null,r.a.createElement(U.a,{variant:"h5"},"Data Summary"),r.a.createElement("ul",null,r.a.createElement("li",{key:"datapoints"},t.length," data points over ",a.length," days"),r.a.createElement("li",{key:"temp"},"Average temperature ",J(t,"temperature")),r.a.createElement("li",{key:"hum"},"Average humidity ",J(t,"humidity"))))},_=a(25),q=a.n(_),z=a(228),P=a.n(z),Q=a(229),V=a.n(Q),X=a(230),Y=a.n(X),Z=a(231),$=a.n(Z),ee=a(233),te=a.n(ee),ae=a(87),ne=a.n(ae),re=a(232),ie=a.n(re),le=a(128),ce=a.n(le),se=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).selectSensor=function(e){return function(){console.log("Sensor ".concat(e," is being selected"));var t=a.state.readings.filter(function(t){return t.sensorname===e});a.setState({selectedSensor:e,chosenReadings:t})}},a.handleTabChange=function(e,t){a.setState({currentTab:t}),a.filterReadings()},a.handleRangeChange=function(e,t){a.setState({range:t}),a.filterReadings()},a.toMilliseconds=function(e){return 24*e*60*60*1e3},a.filterReadings=function(){var e=a.state.readings.filter(function(e){return e.sensorname===a.state.selectedSensor}).filter(function(e){return(new Date).getTime()-new Date(e.date).getTime()<=a.toMilliseconds(a.state.range)});a.setState({chosenReadings:e})},a.calculateDateBoundaries=function(){return a.state.chosenReadings.map(function(e){return new Date(e.date).setHours(0,0,0,0,0)}).filter(function(e,t,a){return a.indexOf(e)===t}).map(function(e){return new Date(e).getTime()})},a.calculateAverage=function(e,t){var a=e.reduce(function(e,a){return e+a[t]},0);return Math.round(a/e.length*100)/100},a.state={sensors:[],readings:[],chosenReadings:[],selectedSensor:"",currentTab:0,range:14},console.log("constructor"),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("App did mount"),E().then(function(t){console.log("Sensors promise fulfilled"),e.setState({sensors:t,selectedSensor:t[0].name})}),h().then(function(t){console.log("Readings promise fulfilled"),e.setState({readings:t}),e.filterReadings()}),this.setState({currentTab:0})}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(N,null),r.a.createElement(q.a,{container:!0,spacing:8,alignItems:"center",justify:"center"},r.a.createElement(q.a,{item:!0,xs:6},r.a.createElement(L,{user:"Ossian"})),r.a.createElement(q.a,{item:!0,xs:6},r.a.createElement(F,null))),r.a.createElement(P.a,{value:this.state.currentTab,onChange:this.handleTabChange,indicatorColor:"primary",textColor:"primary",centered:!0},this.state.sensors.map(function(t){return r.a.createElement(V.a,{key:t.name,as:"button",onClick:e.selectSensor(t.name),label:t.name})})),r.a.createElement(q.a,{container:!0,spacing:8,alignItems:"center",justify:"center"},r.a.createElement(q.a,{item:!0,xs:10,md:8},r.a.createElement(Y.a,{classes:{container:t.slider},value:this.state.range,min:1,max:14,step:1,onChange:this.handleRangeChange}),r.a.createElement("p",null,this.state.range," ",this.state.range<1?" hours":" day(s)")),r.a.createElement(q.a,{item:!0,xs:12,md:6},r.a.createElement(U.a,{align:"center",variant:"h5"},"Temperature"),r.a.createElement(G,{data:this.state.chosenReadings,yDataKeys:["temperature","temperatureOut"],yUnit:"\xb0",yDomain:[-10,30],xDataKey:"date",boundaries:this.calculateDateBoundaries()})),r.a.createElement(q.a,{item:!0,xs:12,md:6},r.a.createElement(U.a,{align:"center",variant:"h5"},"Humidity"),r.a.createElement(G,{data:this.state.chosenReadings,yDataKeys:["humidity","humidityOut"],yUnit:"%",yDomain:[10,100],xDataKey:"date",boundaries:this.calculateDateBoundaries()})),r.a.createElement(q.a,{item:!0,xs:12,md:5},r.a.createElement(W,{data:this.state.chosenReadings,boundaries:this.calculateDateBoundaries()})),r.a.createElement(q.a,{item:!0,xs:12,md:5},r.a.createElement(U.a,{variant:"h5"},"Sensors"),r.a.createElement($.a,null,r.a.createElement(ie.a,null,r.a.createElement(ce.a,null,r.a.createElement("th",null,"Sensorname"),r.a.createElement("th",null,"First online"),r.a.createElement("th",null,"Last online"))),r.a.createElement(te.a,null,this.state.sensors.map(function(e){return r.a.createElement(ce.a,{key:e._id},r.a.createElement(ne.a,null,e.name),r.a.createElement(ne.a,null,new Date(e.firstonline).toLocaleString("fi-FI")),r.a.createElement(ne.a,null,new Date(e.lastonline).toLocaleString("fi-FI")))}))))))}}]),t}(r.a.Component),oe=Object(f.withStyles)({root:{flexGrow:1},slider:{padding:"22px 0px"}})(se);l.a.render(r.a.createElement(oe,null),document.getElementById("root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.46182feb.chunk.js.map